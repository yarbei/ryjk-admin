webpackJsonp([15],{"4SNz":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),o=r.n(a),s=r("Dd8w"),i=r.n(s),n={data:function(){return{optionsList:[],filters:{title:""},objectList:[{label:"全部",value:0},{label:"仅患者",value:1},{label:"仅医生",value:2},{label:"仅疾病管理师",value:3},{label:"指定人群",value:4}],addForm:{}}},methods:{cancel:function(){console.log(1),this.$router.go(-1)},addDepartment:function(){var e=this,t=i()({},this.addForm);if(4!==t.titleType)delete t.receiverUserId;else{var r=this.addForm.receiverUserId.map(function(e,t){return{userId:e}});t.receiverUserId=o()(r)}console.log(t),this.$http.post("/api/notice/addNoticeTask",t).then(function(t){t.data?e.$message({type:"success",message:"新增公告成功",duration:1e3,onClose:function(){e.$router.push("/noticeManagement")}}):e.$message.error("新增公告失败")}).catch(function(e){console.log(e)})},getUserList:function(){var e=this;this.$http.get("/api/user/userList").then(function(t){t.data&&(e.optionsList=t.data)}).catch(function(e){console.log(e)})},getDetail:function(e){var t=this;this.$http.get("/api/notice/noticeTask?noticeTaskId="+e).then(function(e){if(e.data){console.log(e.data);var r=e.data;t.addForm=i()({},r),t.addForm.receiverUserId=[],console.log(r.receiverUserId);var a=JSON.parse(r.receiverUserId);console.log(a),a.map(function(e,r){t.addForm.receiverUserId.push(e.userId)})}}).catch(function(e){console.log(e)})},setDepartment:function(e){var t=this,r=i()({},this.addForm);if(4!==r.titleType)delete r.receiverUserId;else{var a=this.addForm.receiverUserId.map(function(e,t){return{userId:e}});r.receiverUserId=o()(a)}r.noticeTaskId=Number(e),console.log(r),this.$http.post("/api/notice/updateNoticeTask",r).then(function(e){e.data?t.$message({type:"success",message:"修改公告成功",duration:1e3,onClose:function(){t.$router.push("/noticeManagement")}}):t.$message.error("修改公告失败")}).catch(function(e){console.log(e)})},save:function(){var e=this.$route.query.id;e?this.setDepartment(e):this.addDepartment()}},mounted:function(){this.getUserList()},created:function(){var e=this.$route.query.id;this.id=e,e&&this.getDetail(e)}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"table_container"},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"公告标题",prop:"title"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"公告内容",prop:"content"}},[r("el-input",{attrs:{type:"textarea",rows:5,"auto-complete":"off"},model:{value:e.addForm.content,callback:function(t){e.$set(e.addForm,"content",t)},expression:"addForm.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"接收对象",prop:"titleType"}},[r("el-select",{attrs:{placeholder:"接收对象"},model:{value:e.addForm.titleType,callback:function(t){e.$set(e.addForm,"titleType",t)},expression:"addForm.titleType"}},e._l(e.objectList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:4===e.addForm.titleType,expression:"addForm.titleType === 4"}],attrs:{label:"指定人群",prop:"receiverUserId"}},[r("el-select",{attrs:{multiple:"",filterable:"",remote:"",placeholder:"请搜索用户"},model:{value:e.addForm.receiverUserId,callback:function(t){e.$set(e.addForm,"receiverUserId",t)},expression:"addForm.receiverUserId"}},e._l(e.optionsList,function(t){return r("el-option",{key:t.userId,attrs:{label:t.userName,value:t.userId}},[e._v("\n                  "+e._s(t.userName)+"\n              ")])}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"发送时间",prop:"pushTime"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择发送时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.addForm.pushTime,callback:function(t){e.$set(e.addForm,"pushTime",t)},expression:"addForm.pushTime"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{nativeOn:{click:function(t){return e.cancel(t)}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.save(t)}}},[e._v("提交")])],1)],1)},staticRenderFns:[]};var c=r("VU/8")(n,l,!1,function(e){r("dJTL")},"data-v-6d185c2b",null);t.default=c.exports},dJTL:function(e,t){}});