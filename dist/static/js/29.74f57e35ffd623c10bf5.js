webpackJsonp([29],{i7Qt:function(e,t){},tVrb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("woOf"),r=a.n(o),i=a("mvHQ"),l=a.n(i),s={data:function(){var e=function(e,t,a){if(!1===/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(t))return a(new Error("请输入正确的手机号")),!1;a()};return{filters:{name:""},groupNameList:[{groupId:"",groupName:""}],ksdepartmentName:[],groupNameChoose:"",value:"",total:20,page:1,listLoading:!1,sels:[],usersList:[],editFormVisible:!1,editLoading:!1,editFormRules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}]},editForm:{},addFormVisible:!1,addFormVisible1:!1,addLoading:!1,addFormRules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,validator:e,trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"change"}],idCard:[{required:!0,validator:function(e,t,a){if(!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t))return a(new Error("请输入正确的身份证号")),!1;a()},trigger:"blur"}],telName:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],relationPhone:[{required:!0,validator:e,trigger:"blur"}],relation:[{required:!0,message:"请选择与患者关系",trigger:"change"}],groupId:[{required:!0,message:"请选择分组",trigger:"change"}]},addForm:{departmentName:[]},user:null,pageTotal:0,pageSize:0,newGroupName:"",getPatientId:null}},methods:{addGroup:function(){this.addFormVisible1=!0},createPlan:function(e,t){sessionStorage.setItem("personInfo",l()(t)),this.$router.push({name:"createPlan",params:{id:e,info:t}})},essentialInfo:function(e,t){sessionStorage.setItem("personInfo",l()(t)),this.$router.push({name:"EssentialInfo"})},editGroup:function(e){this.editForm.groupId=e},editInfo:function(e,t){this.editFormVisible=!0,this.getPatientId=t.id,this.editForm=r()({},t),null!=t.groupId?this.editForm.groupId=t.groupId.groupId:this.editForm.groupId=t.groupId},editSubmit:function(){var e=this;this.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0,e.$http.post("/api/patient/updateGroup",{userId:e.getPatientId,groupId:e.editForm.groupId}).then(function(t){t.data?(e.$message({showClose:!0,message:"修改组别成功",type:"success"}),e.editLoading=!1,e.editFormVisible=!1,e.getUsers()):(e.$message({showClose:!0,message:"修改组别失败",type:"error"}),e.editLoading=!1,e.editFormVisible=!1)}).catch(function(e){console.log(e)})})},createVisit:function(e,t){sessionStorage.setItem("personInfo",l()(t)),this.$router.replace({name:"EssentialInfo",params:{selectId:"jhxx"}})},deletePatient:function(e,t){var a=this;console.log(e,t),1===t.sourceType?this.$confirm("此操作将删除该患者, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post("/apipatient/deletePatientById?id="+t.id).then(function(e){a.getUsers(),a.$message({type:"success",message:"删除成功!"})}).catch(function(e){console.log(e),a.$message({type:"warning",message:"删除失败!"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})}):this.$message.warning("该患者不可删除！")},formatSex:function(e,t){return 1===e.sex?"男":2===e.sex?"女":"未知"},handleCurrentChange:function(e){console.log(e)},getMedicalList:function(){var e=this;this.$http.get("/api/medicalSections/getMedicalSectionsList?hospitalId="+this.$store.state.user.user.hospitalId.id).then(function(t){e.ksdepartmentName=t.data}).catch(function(e){console.log(e)})},getUsers:function(){var e=this;this.user=JSON.parse(sessionStorage.getItem("loginUser")),this.$http.get("/api/patient/getPatientList?hospitalId="+this.user.hospitalId.id+"&keywords="+this.filters.name).then(function(t){e.pageTotal=t.data.total,e.pageSize=t.data.size,e.usersList=t.data.list}).catch(function(e){console.log(e)})},handleEdit:function(e,t){this.editFormVisible=!0,this.editForm=r()({},t)},addPatient:function(){this.addFormVisible=!0,this.addForm={name:"",sex:-1,age:0,idCard:"",groupId:"",remark:"",phone:""}},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){t&&(e.addForm.hospitalId=e.user.hospitalId.id,e.addForm.doctorId=e.user.id,e.$confirm("确认提交吗？","提示",{}).then(function(){-1!==e.addForm.sex?""!=e.addForm.groupId?(e.addLoading=!0,e.$http.post("/api/patient/addPatient",e.addForm).then(function(t){t.data?(e.$message({showClose:!0,message:"患者添加成功",type:"success"}),e.getUsers(),e.addFormVisible=!1,e.$refs.addForm.resetFields()):(e.$message({showClose:!0,message:"患者添加失败",type:"error"}),e.addFormVisible=!1,e.$refs.addForm.resetFields())}).catch(function(e){console.log(e)})):e.$message({showClose:!0,message:"您还未选择组别",type:"error"}):e.$message({showClose:!0,message:"您还未选择性别",type:"error"})}))})},addClose:function(){this.addFormVisible=!1,this.editFormVisible=!1,this.$refs.addForm.resetFields()},closeDialog:function(){this.$refs.addForm.resetFields()},selsChange:function(e){this.sels=e},getGroupName:function(){var e=this;this.$http.get("/api/groups/getGroupListByDoctorId?doctorId="+this.user.id).then(function(t){e.groupNameList=t.data}).catch(function(e){console.log(e)})},addNewGroup:function(){var e=this;this.$http.post("/api/groups/addGroup",{groupName:this.newGroupName,doctorId:this.user.id}).then(function(t){t.data?(e.$message({showClose:!0,message:"新建组别成功",type:"success"}),e.addFormVisible1=!1,e.getGroupName(),e.newGroupName=""):(e.$message({showClose:!0,message:"新建组别失败",type:"error"}),e.addFormVisible1=!1)}).catch(function(e){console.log(e)})},getUsersByGroup:function(){var e=this;""===this.groupNameChoose?this.getUsers():this.$http.get("/api/patient/getPatientList?hospitalId="+this.user.hospitalId.id+"&groupId="+this.groupNameChoose).then(function(t){e.pageTotal=t.data.total,e.pageSize=t.data.size,e.usersList=t.data.list}).catch(function(e){console.log(e)})}},created:function(){this.getMedicalList(),this.getUsers(),this.getGroupName()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"table_container"},[a("el-col",{staticClass:"toolbar toolbar_title",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("h3",[e._v("患者操作")]),e._v(" "),a("el-form",{staticClass:"toolbar_form",attrs:{inline:!0,model:e.filters}},[a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{clearable:"",placeholder:"选择组名"},on:{change:e.getUsersByGroup},model:{value:e.groupNameChoose,callback:function(t){e.groupNameChoose=t},expression:"groupNameChoose"}},e._l(e.groupNameList,function(e){return a("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1),e._v(" "),a("el-form-item",{staticClass:"f-right search_input"},[a("el-input",{attrs:{placeholder:"患者姓名/手机号/身份证号"},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,"name",t)},expression:"filters.name"}},[a("template",{attrs:{icon:"el-icon-search"},slot:"append"},[a("el-button",{staticStyle:{"background-color":"#52d7ac","border-radius":"0",color:"#fff",border:"1px solid #52d7ac"},attrs:{type:"primary"},on:{click:e.getUsers}},[a("i",{staticClass:"el-icon-search",staticStyle:{"margin-right":"5px"}}),e._v("搜索\n            ")])],1)],2)],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"background-color":"#52a3d7",border:"0","font-size":"14px"},attrs:{type:"primary"},on:{click:e.addGroup}},[e._v("新建组别")])],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"background-color":"#52d7ac",border:"0","font-size":"14px"},attrs:{type:"primary"},on:{click:e.addPatient}},[e._v("新建患者")])],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"background-color":"#52a3d7",border:"0","font-size":"14px"},attrs:{type:"primary"}},[a("i",{staticClass:"el-icon-download",staticStyle:{"margin-right":"5px"}}),e._v("导出\n        ")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.usersList,border:!0,stripe:"","highlight-current-row":""},on:{"selection-change":e.selsChange}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:"姓名",width:"80",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"groupId.groupName",align:"center",width:"100",label:"组名",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"idCard",align:"center",label:"身份证号",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",align:"center",label:"性别",width:"80",formatter:e.formatSex,sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"age",align:"center",label:"年龄",width:"80",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",align:"center",label:"电话",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"departmentName",align:"center",width:"150",label:"科室",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"doctorName",align:"center",width:"120",label:"责任医生",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"#52a3d7"},attrs:{round:"",type:"text"},on:{click:function(a){return e.createPlan(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"5px"}}),e._v("创建计划\n        ")]),e._v(" "),a("el-button",{staticStyle:{color:"#52a3d7"},attrs:{round:"",type:"text"},on:{click:function(a){return e.essentialInfo(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-search",staticStyle:{"margin-right":"5px"}}),e._v("查看详情\n        ")]),e._v(" "),a("el-button",{staticStyle:{color:"#f8b14b"},attrs:{round:"",type:"text"},on:{click:function(a){return e.editInfo(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-edit-outline",staticStyle:{"margin-right":"5px"}}),e._v("修改分组\n        ")]),e._v(" "),a("el-button",{staticStyle:{color:"#7de1c1"},attrs:{round:"",type:"text"},on:{click:function(a){return e.createVisit(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"5px"}}),e._v("新增随访\n        ")]),e._v(" "),a("el-button",{staticStyle:{color:"#7de1c1"},attrs:{round:"",type:"text"},on:{click:function(a){return e.deletePatient(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete",staticStyle:{"margin-right":"5px"}}),e._v("删除患者\n        ")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"修改患者分组",visible:e.editFormVisible,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"120px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"患者姓名",prop:"name"}},[a("el-input",{attrs:{disabled:"","auto-complete":"off"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-radio-group",{attrs:{disabled:""},model:{value:e.editForm.sex,callback:function(t){e.$set(e.editForm,"sex",t)},expression:"editForm.sex"}},[a("el-radio",{staticClass:"radio",attrs:{label:1}},[e._v("男")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:2}},[e._v("女")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"患者手机号"}},[a("el-input",{attrs:{disabled:"","auto-complete":"off"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者身份证"}},[a("el-input",{attrs:{disabled:"","auto-complete":"off"},model:{value:e.editForm.idCard,callback:function(t){e.$set(e.editForm,"idCard",t)},expression:"editForm.idCard"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者科室"}},[a("el-input",{attrs:{disabled:"","auto-complete":"off"},model:{value:e.editForm.departmentName,callback:function(t){e.$set(e.editForm,"departmentName",t)},expression:"editForm.departmentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者责任医生"}},[a("el-input",{attrs:{disabled:"","auto-complete":"off"},model:{value:e.editForm.diseaseManagerName,callback:function(t){e.$set(e.editForm,"diseaseManagerName",t)},expression:"editForm.diseaseManagerName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者分组"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.editGroup},model:{value:e.editForm.groupId,callback:function(t){e.$set(e.editForm,"groupId",t)},expression:"editForm.groupId"}},e._l(e.groupNameList,function(e){return a("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新建患者",visible:e.addFormVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"100px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"患者性别",prop:"sex"}},[a("el-radio-group",{model:{value:e.addForm.sex,callback:function(t){e.$set(e.addForm,"sex",t)},expression:"addForm.sex"}},[a("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("女")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"患者电话",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证号",prop:"idCard"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.idCard,callback:function(t){e.$set(e.addForm,"idCard",t)},expression:"addForm.idCard"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择科室 : "}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.departmentName,callback:function(t){e.$set(e.addForm,"departmentName",t)},expression:"addForm.departmentName"}},e._l(e.ksdepartmentName,function(e){return a("el-option",{key:e.value,attrs:{value:e.label,label:e.label}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人姓名",prop:"telName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.telName,callback:function(t){e.$set(e.addForm,"telName",t)},expression:"addForm.telName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人电话",prop:"relationPhone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.relationPhone,callback:function(t){e.$set(e.addForm,"relationPhone",t)},expression:"addForm.relationPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"与患者关系",prop:"relation"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.relation,callback:function(t){e.$set(e.addForm,"relation",t)},expression:"addForm.relation"}},[a("el-option",{attrs:{value:"父母",label:"父母"}}),e._v(" "),a("el-option",{attrs:{value:"子女",label:"子女"}}),e._v(" "),a("el-option",{attrs:{value:"配偶",label:"配偶"}}),e._v(" "),a("el-option",{attrs:{value:"朋友",label:"朋友"}}),e._v(" "),a("el-option",{attrs:{value:"同事",label:"同事"}}),e._v(" "),a("el-option",{attrs:{value:"同学",label:"同学"}}),e._v(" "),a("el-option",{attrs:{value:"其他",label:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分组",prop:"groupId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.groupId,callback:function(t){e.$set(e.addForm,"groupId",t)},expression:"addForm.groupId"}},e._l(e.groupNameList,function(e){return a("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){return e.addClose(t)}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新建组别",visible:e.addFormVisible1,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible1=t}}},[a("el-form",[a("el-form-item",{staticClass:"new_group",attrs:{label:"组名","label-width":"80px"}},[a("el-input",{attrs:{placeholder:"请输入组别名称"},model:{value:e.newGroupName,callback:function(t){e.newGroupName=t},expression:"newGroupName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible1=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addNewGroup(t)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(s,n,!1,function(e){a("i7Qt")},"data-v-2e57095d",null);t.default=d.exports}});